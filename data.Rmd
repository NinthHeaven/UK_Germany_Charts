---
title: "Milestone 4"
author: "Saul Soto"
date: "3/6/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(knitr)
library(spotifyr)
library(lubridate)
library(readxl)
library(janitor)
library(rvest)
library(infer)
library(magrittr)
library(hrbrthemes)
library(extrafont)
Sys.setenv(SPOTIFY_CLIENT_ID = '1ebacb60ef2044ccadab18602f7c0b8f')
Sys.setenv(SPOTIFY_CLIENT_SECRET = '6fb54464f8dc45c88387a4fadde775db')

access_token <- get_spotify_access_token()

# So it turns out that I am completely unable to get any data from Germany or
# the UK because I have a USA Spotify account. What I will do for this milestone
# is get the spotify top 200 tracks for the past 3 Februarys (Spotify only has
# data up until 2017) and store them in their own dataframe (UK and Germany).
# Since the dataframes do not give me details about the genre or any analysis,
# that means I'll have to do it individually for every song, which is a little
# absurd given the time for this project. My plan is to hopefully get Spotify to
# give me access to the global market, if not I will narrow my project.

top_200_2020_uk <- read.csv("raw-data/regional-gb-daily-latest.csv", skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2020"))

top_200_2019_uk <- read.csv("raw-data/regional-gb-daily-2019-02-28.csv", skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2019"))

top_200_2018_uk <- read.csv("raw-data/regional-gb-daily-2018-02-28.csv", skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2018"))

top_200_2017_uk <- read.csv("raw-data/regional-gb-daily-2017-02-28.csv", skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2017"))

# Here is the Germany data that I will hopefully end up using for my final
# project. I do have some other ideas, such as compare the analysis of the EDM
# audio tracks that do make it to the US top 200 on Spotify and compare it to
# the analysis of whatever genres dominate the US charts.

top_200_2020_ger <- read.csv("raw-data-ger/regional-de-daily-latest.csv", skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2020"))

top_200_2019_ger <- read.csv("raw-data-ger/regional-de-daily-2019-02-28.csv",
                             skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2019"))

top_200_2018_ger <- read.csv("raw-data-ger/regional-de-daily-2018-02-28.csv", 
                             skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2018"))

top_200_2017_ger <- read.csv("raw-data-ger/regional-de-daily-2017-02-28.csv",
                             skip = 1) %>%
  clean_names() %>%
  select(1:3) %>%
  mutate(year = rep("2017"))

# Alternatively, I can also try to see which songs match, and get the analytics
# of the tracks that match and what position they rank in in the UK and Ger
# markets retrospectively. Of course, this can only be possible if the songs are
# also available in the US market. I can also just do what I originally wanted
# to with the 2000-2010 data and just focus on the data I've collected just now.

top_uk_total <- rbind(top_200_2020_uk, top_200_2019_uk, 
                    top_200_2018_uk, top_200_2017_uk)
total_ger_total <- rbind(top_200_2020_ger, top_200_2019_ger,
                         top_200_2018_ger, top_200_2017_ger)
```

```{r ukcharts, echo=FALSE}
# I added this because I thought it would fix the problem with spotify returning
# NULL observations, but it did not :(

options(stringsAsFactors = FALSE)

# Thank you Mitchell for the lines of code below!!

uk2000_hits <- "http://www.uk-charts.top-source.info/top-100-2000.shtml" %>%
  read_html()

uk_2000_data <- html_nodes(uk2000_hits, "td") %>% 
  html_text()

# Okay so contrary to my belief, rep will not be the best way to split the list
# up, but the as.data.frame function will automatically continue to split the
# first three rows into a separate column. Perhaps there is another way to do
# this, but I like this method for now.

uk_2000_data <- as.data.frame(split(uk_2000_data, 1:3)) %>% 
  rename(position = X1,
         artist = X2,
         title = X3)

## Test out if Spotify will give me the genres of titles. This does not work at
## the moment, but I believe that once I figure this aspect out, it shall be
## easy to move onwards with the data-gathering.

# get_track_audio_features(uk_2000_data$title)

## Get tracks from 2001-2010 in UK

uk2001_hits <- "http://www.uk-charts.top-source.info/top-100-2001.shtml" %>%
  read_html()

uk2001_hits <- html_nodes(uk2001_hits, "td") %>%
  html_text()

uk2001_data <- as.data.frame(split(uk2001_hits, 1:3)) %>% 
  rename(position = X1,
         artist = X2,
         title = X3)

uk2002_hits <- "http://www.uk-charts.top-source.info/top-100-2002.shtml" %>%
  read_html()

uk2002_hits <- html_nodes(uk2002_hits, "td") %>%
  html_text()

uk2002_data <- as.data.frame(split(uk2002_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2003_hits <- "http://www.uk-charts.top-source.info/top-100-2003.shtml" %>%
  read_html()

uk2003_hits <- html_nodes(uk2003_hits, "td") %>%
  html_text()

uk2003_data <- as.data.frame(split(uk2003_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2004_hits <- "http://www.uk-charts.top-source.info/top-100-2004.shtml" %>%
  read_html()

uk2004_hits <- html_nodes(uk2004_hits, "td") %>%
  html_text()

uk2004_data <- as.data.frame(split(uk2004_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2005_hits <- "http://www.uk-charts.top-source.info/top-100-2005.shtml" %>%
  read_html()

uk2005_hits <- html_nodes(uk2005_hits, "td") %>%
  html_text()

uk2005_data <- as.data.frame(split(uk2005_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2006_hits <- "http://www.uk-charts.top-source.info/top-100-2006.shtml" %>%
  read_html()

uk2006_hits <- html_nodes(uk2006_hits, "td") %>%
  html_text()

uk2006_data <- as.data.frame(split(uk2006_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2007_hits <- "http://www.uk-charts.top-source.info/top-100-2007.shtml" %>%
  read_html()

uk2007_hits <- html_nodes(uk2007_hits, "td") %>%
  html_text()

uk2007_data <- as.data.frame(split(uk2007_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2008_hits <- "http://www.uk-charts.top-source.info/top-100-2008.shtml" %>%
  read_html()

uk2008_hits <- html_nodes(uk2008_hits, "td") %>%
  html_text()

uk2008_data <- as.data.frame(split(uk2008_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2009_hits <- "http://www.uk-charts.top-source.info/top-100-2009.shtml" %>%
  read_html()

uk2009_hits <- html_nodes(uk2009_hits, "td") %>%
  html_text()

uk2009_data <- as.data.frame(split(uk2009_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

uk2010_hits <- "http://www.uk-charts.top-source.info/top-100-2010.shtml" %>%
  read_html()

uk2010_hits <- html_nodes(uk2010_hits, "td") %>%
  html_text()

uk2010_data <- as.data.frame(split(uk2010_hits, 1:3)) %>%
  rename(position = X1,
         artist = X2,
         title = X3)

# Map function that iterates over every row in track.artists, getting the id and
# feeding it into the get_artist function

ger2000_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2000" %>%
  read_html()

ger2000_hits <- html_nodes(ger2000_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("\\n+", "")%>%
  trimws()%>%
  tibble()

colnames(ger2000_hits)<-c("Column")

ger2000_hits<- ger2000_hits %>% 
  mutate(Names=str_split(Column,"\\s{36}"))

ger2000_data <- data.frame(matrix(unlist(ger2000_hits$Names),
                                  nrow=100, byrow=T),stringsAsFactors=FALSE)

ger2001_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2001" %>%
  read_html()

ger2001_hits <- html_nodes(ger2001_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2001_hits)<-c("Column")

ger2001_hits <- ger2001_hits %>%
  mutate(Names=str_split(Column, "\\s{36}"))

ger2001_data <- data.frame(matrix(unlist(ger2001_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2002_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2002" %>%
  read_html()

ger2002_hits <- html_nodes(ger2002_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2002_hits)<-c("Column")

ger2002_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2002_data <- data.frame(matrix(unlist(ger2002_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2003_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2003" %>%
  read_html()

ger2003_hits <- html_nodes(ger2003_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2003_hits)<-c("Column")

ger2003_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2003_data <- data.frame(matrix(unlist(ger2003_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2004_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2004" %>%
  read_html()

ger2004_hits <- html_nodes(ger2004_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2004_hits)<-c("Column")

ger2004_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2004_data <- data.frame(matrix(unlist(ger2004_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2005_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2005" %>%
  read_html()

ger2005_hits <- html_nodes(ger2005_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2005_hits)<-c("Column")

ger2005_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2005_data <- data.frame(matrix(unlist(ger2005_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2006_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2006" %>%
  read_html()

ger2006_hits <- html_nodes(ger2006_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2006_hits)<-c("Column")

ger2006_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2006_data <- data.frame(matrix(unlist(ger2006_hits$Names),
                                  nrow=100,
                                  byrow = T),
                           stringsAsFactors = FALSE)

ger2007_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2007" %>%
  read_html()

ger2007_hits <- html_nodes(ger2007_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2007_hits)<-c("Column")

ger2007_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2007_data <- data.frame(matrix(unlist(ger2007_hits$Names),
                                  nrow=100,
                                  byrow = T), stringsAsFactors = FALSE)

ger2008_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2008" %>%
  read_html()

ger2008_hits <- html_nodes(ger2008_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2008_hits)<-c("Column")

ger2008_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2008_data <- data.frame(matrix(unlist(ger2008_hits$Names),
                                  nrow=100,
                                  byrow = T), stringsAsFactors = FALSE)

ger2009_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2009" %>%
  read_html()

ger2009_hits <- html_nodes(ger2009_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2009_hits)<-c("Column")

ger2009_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2009_data <- data.frame(matrix(unlist(ger2009_hits$Names),
                                  nrow=100,
                                  byrow = T), stringsAsFactors = FALSE)

ger2010_hits <- "https://www.offiziellecharts.de/charts/single-jahr/for-date-2010" %>%
  read_html()

ger2010_hits <- html_nodes(ger2010_hits, ".year-mode") %>%
  html_text() %>%
  str_replace_all("//n+", "") %>%
  trimws() %>%
  tibble()

colnames(ger2010_hits)<-c("Column")

ger2010_hits %<>% mutate(Names=str_split(Column, "\\s{36}"))

ger2010_data <- data.frame(matrix(unlist(ger2010_hits$Names),
                                  nrow=100,
                                  byrow = T), stringsAsFactors = FALSE)

# This will be something I would like to do with the 2000-2010 data. Here is a
# demo with the Spotify Top 200 playlist that I would want to replicate with my
# own data. The problem with my data currently is that the function that should
# be working isn't, and every spotify tutorial uses the same method as mine.
# Also, I do not have access to the Spotify UK/GER markets, so there are songs
# that I am missing from my top playlists. Most of the data I gathered will be
# in the playlists themselves, and I am still trying to figure out how to clean
# up the GER data so I can easily display it somewhere on the website.

# Here I will get the audio features for every year in both uk and germany.

uk_2000 <- get_playlist("7uQBCcnNuxOBv0jFbEcYjH")
uk2000_tracks <- get_playlist_tracks("7uQBCcnNuxOBv0jFbEcYjH")
uk2000_features <- get_track_audio_features(uk2000_tracks$track.id)

uk_2001 <- get_playlist("28MXvLEP4jZ6c5kVIP8ke5")
uk2001_tracks <- get_playlist_tracks("28MXvLEP4jZ6c5kVIP8ke5")
uk2001_features <- get_track_audio_features(uk2001_tracks$track.id)

uk2002 <- get_playlist("7vQW2yhyPeUys745cjd4qW")
uk2002_tracks <- get_playlist_tracks("7vQW2yhyPeUys745cjd4qW")
uk2002_features <- get_track_audio_features(uk2002_tracks$track.id)

uk2003 <- get_playlist("7ajCdWcuELFirRcGl9LKsv")
uk2003_tracks <- get_playlist_tracks("7ajCdWcuELFirRcGl9LKsv")
uk2003_features <- get_track_audio_features(uk2003_tracks$track.id)

# Start here

uk2004 <- get_playlist("4d9CrfTDJ7WgDXL7xy4gnu")
uk2004_tracks <- get_playlist_tracks("4d9CrfTDJ7WgDXL7xy4gnu")
uk2004_features <- get_track_audio_features(uk2004_tracks$track.id)

uk2005 <- get_playlist("2luAWE5y4EjcF3eeecXqqL")
uk2005_tracks <- get_playlist_tracks("2luAWE5y4EjcF3eeecXqqL")
uk2005_features <- get_track_audio_features(uk2005_tracks$track.id)

uk2006 <- get_playlist("246jBtzSV8noLKfwPhxK9L")
uk2006_tracks <- get_playlist_tracks("246jBtzSV8noLKfwPhxK9L")
uk2006_features <- get_track_audio_features(uk2006_tracks$track.id)

uk2007 <- get_playlist("41tjYI2R4zuKCR6Jpkcurs")
uk2007_tracks <- get_playlist_tracks("41tjYI2R4zuKCR6Jpkcurs")
uk2007_features <- get_track_audio_features(uk2007_tracks$track.id)

uk2008 <- get_playlist("2e6HTZLlouOqvX2hFfrK7M")
uk2008_tracks <- get_playlist_tracks("2e6HTZLlouOqvX2hFfrK7M")
uk2008_features <- get_track_audio_features(uk2008_tracks$track.id)

uk2009 <- get_playlist("36Wp100hDpZ39S7rAkeW2B")
uk2009_tracks <- get_playlist_tracks("36Wp100hDpZ39S7rAkeW2B")
uk2009_features <- get_track_audio_features(uk2009_tracks$track.id)

uk2010 <- get_playlist("1oFHWJu7rH78TBCxbUvLne")
uk2010_tracks <- get_playlist_tracks("1oFHWJu7rH78TBCxbUvLne")
uk2010_features <- get_track_audio_features(uk2010_tracks$track.id)

ger2000 <- get_playlist("3mwXtmIDVIImnHEhF25aXk")
ger2000_tracks <- get_playlist_tracks("3mwXtmIDVIImnHEhF25aXk")
ger2000_features <- get_track_audio_features(ger2000_tracks$track.id)

ger2001 <- get_playlist("5Xl6JK20GTICxAQsMjrp93")
ger2001_tracks <- get_playlist_tracks("5Xl6JK20GTICxAQsMjrp93")
ger2001_features <- get_track_audio_features(ger2001_tracks$track.id)

ger2002 <- get_playlist("4pN5sDpaQn5pGVJQJ8Nm7j")
ger2002_tracks <- get_playlist_tracks("4pN5sDpaQn5pGVJQJ8Nm7j")
ger2002_features <- get_track_audio_features(ger2002_tracks$track.id)

ger2003 <- get_playlist("4CfPTjH2UOLZr3FjtbmnPB")
ger2003_tracks <- get_playlist_tracks("4CfPTjH2UOLZr3FjtbmnPB")
ger2003_features <- get_track_audio_features(ger2003_tracks$track.id)

ger2004 <- get_playlist("6RsriY4UcnhHpKNoeVYbu4")
ger2004_tracks <- get_playlist_tracks("6RsriY4UcnhHpKNoeVYbu4")
ger2004_features <- get_track_audio_features(ger2004_tracks$track.id)

ger2005 <- get_playlist("2nfm7TsAcuHr7p1MrOFKcw")
ger2005_tracks <- get_playlist_tracks("2nfm7TsAcuHr7p1MrOFKcw")
ger2005_features <- get_track_audio_features(ger2005_tracks$track.id)

ger2006 <- get_playlist("77N8qjXKrsVVMv8hI8jNxG")
ger2006_tracks <- get_playlist_tracks("77N8qjXKrsVVMv8hI8jNxG")
ger2006_features <- get_track_audio_features(ger2006_tracks$track.id)

ger2007 <- get_playlist("4mwHWiCKwzdIx3ANL19vRY")
ger2007_tracks <- get_playlist_tracks("4mwHWiCKwzdIx3ANL19vRY")
ger2007_features <- get_track_audio_features(ger2007_tracks$track.id)

ger2008 <- get_playlist("3o5sU5OWHsFsbh9FXjYQKE")
ger2008_tracks <- get_playlist_tracks("3o5sU5OWHsFsbh9FXjYQKE")
ger2008_features <- get_track_audio_features(ger2008_tracks$track.id)

ger2009 <- get_playlist("1teQpbhtQztADlDeANRwUs")
ger2009_tracks <- get_playlist_tracks("1teQpbhtQztADlDeANRwUs")
ger2009_features <- get_track_audio_features(ger2009_tracks$track.id)

ger2010 <- get_playlist("1RZV5fBYJUEfeYbT9kiDnk")
ger2010_tracks <- get_playlist_tracks("1RZV5fBYJUEfeYbT9kiDnk")
ger2010_features <- get_track_audio_features(ger2010_tracks$track.id)


same_tracks_2020 <- top_200_2020_uk %>%
  inner_join(top_200_2020_ger, by = c("track_name", "artist", "year"))

same_tracks_2019 <- top_200_2019_uk %>%
  inner_join(top_200_2019_ger, by = c("track_name", "artist", "year"))

same_tracks_2018 <- top_200_2018_uk %>%
  inner_join(top_200_2018_ger, by = c("track_name", "artist", "year"))

same_tracks_2017 <- top_200_2017_uk %>%
  inner_join(top_200_2017_ger, by = c("track_name", "artist", "year"))

# Here I store all the danceability, valence, and tempo features per year.

danceability_uk_2000 <- uk2000_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2000") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2000 <- uk2000_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2000") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2000 <- uk2000_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2000") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2000 <- uk2000_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2000") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2001 <- uk2001_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2001") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2001 <- uk2001_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2001") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2001 <- uk2001_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2001") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2001 <- uk2001_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2001") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2002 <- uk2002_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2002") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2002 <- uk2002_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2002") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2002 <- uk2002_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2002") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2002 <- uk2002_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2002") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2003 <- uk2003_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2003") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2003 <- uk2003_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2003") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2003 <- uk2003_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2003") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2003 <- uk2003_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2003") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2004 <- uk2004_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2004") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2004 <- uk2004_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2004") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2004 <- uk2004_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2004") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2004 <- uk2004_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2004") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2005 <- uk2005_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2005") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2005 <- uk2005_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2005") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2005 <- uk2005_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2005") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2005 <- uk2005_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2005") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2006 <- uk2006_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2006") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2006 <- uk2006_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2006") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2006 <- uk2006_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2006") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2006 <- uk2006_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2006") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2007 <- uk2007_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2007") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2007 <- uk2007_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2007") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2007 <- uk2007_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2007") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2007 <- uk2007_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2007") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2008 <- uk2008_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2008") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2008 <- uk2008_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2008") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2008 <- uk2008_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2008") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2008 <- uk2008_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2008") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2009 <- uk2009_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2009") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2009 <- uk2009_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2009") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2009 <- uk2009_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2009") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2009 <- uk2009_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2009") +
  theme_ipsum(base_family = "Calibri")

danceability_uk_2010 <- uk2010_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in UK Charts 2010") +
  theme_ipsum(base_family = "Calibri")

valence_uk_2010 <- uk2010_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in UK Charts 2010") +
  theme_ipsum(base_family = "Calibri") 

tempo_uk_2010 <- uk2010_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in UK Charts 2010") +
  theme_ipsum(base_family = "Calibri")

energy_uk_2010 <- uk2010_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in UK Charts 2010") +
  theme_ipsum(base_family = "Calibri")

# Here are the germany datas

danceability_ger_2000 <- ger2000_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2000") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2000 <- ger2000_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2000") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2000 <- ger2000_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2000") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2000 <- ger2000_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2000") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2001 <- ger2001_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2001") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2001 <- ger2001_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2001") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2001 <- ger2001_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2001") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2001 <- ger2001_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2001") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2002 <- ger2002_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2002") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2002 <- ger2002_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2002") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2002 <- ger2002_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2002") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2002 <- ger2002_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2002") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2003 <- ger2003_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2003") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2003 <- ger2003_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2003") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2003 <- ger2003_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2003") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2003 <- ger2003_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2003") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2004 <- ger2004_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2004") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2004 <- ger2004_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2004") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2004 <- ger2004_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2004") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2004 <- ger2004_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2004") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2005 <- ger2005_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2005") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2005 <- ger2005_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2005") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2005 <- ger2005_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2005") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2005 <- ger2005_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2005") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2006 <- ger2006_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2006") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2006 <- ger2006_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2006") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2006 <- ger2006_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2006") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2006 <- ger2006_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2006") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2007 <- ger2007_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2007") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2007 <- ger2007_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2007") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2007 <- ger2007_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2007") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2007 <- ger2007_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2007") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2008 <- ger2008_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2008") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2008 <- ger2008_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2008") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2008 <- ger2008_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2008") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2008 <- ger2008_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2008") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2009 <- ger2009_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2009") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2009 <- ger2009_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2009") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2009 <- ger2009_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2009") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2009 <- ger2009_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2009") +
  theme_ipsum(base_family = "Calibri")

danceability_ger_2010 <- ger2010_features %>%
  ggplot(aes(danceability)) +
  geom_density(fill = "#faac0f", colour = "#fcab08", alpha = 0.7) +
  ggtitle("Danceability Distribution in Germany Charts 2010") +
  theme_ipsum(base_family = "Calibri")

valence_ger_2010 <- ger2010_features %>%
  ggplot(aes(valence)) +
  geom_density(fill = "#69b3a2", colour = "#e9ecef", alpha = 0.7) +
  ggtitle("Valence Distribution in Germany Charts 2010") +
  theme_ipsum(base_family = "Calibri")

tempo_ger_2010 <- ger2010_features %>%
  ggplot(aes(tempo)) +
  geom_density(fill = "#4287f5", colour = "#316fd4", alpha = 0.7) +
  ggtitle("Tempo Distribution in Germany Charts 2010") +
  theme_ipsum(base_family = "Calibri")

energy_ger_2010 <- ger2010_features %>%
  ggplot(aes(energy)) +
  geom_density(fill = "#f2493d", colour = "#f090e9", alpha = 0.7) +
  ggtitle("Energy Distribution in Germany Charts 2010") +
  theme_ipsum(base_family = "Calibri")


# Testing for function


# What function should do: Get the genres from each song. Then, I would use a
# map function and paste the genres onto a new column in the uk2000_genre df.

get_genre <- function(df) {
  for(i in 1:nrow(df)) {
    SongID <- df$track.artist[[i]][[2]]
    SongGenre <- get_artist(SongID[1])
    df$genre[i] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
  }
  df
}

get_track_artist <- function(col) {
  SongID <- col[[1]][[2]]
  
  SongID
}

get_track_artist(uk2000_tracks$track.artist[1])

uk2000_tracks %<>%
  unnest(c)
  mutate(SongID = map_chr(track.artist[1], ~ get_track_artist))
# Solution to getting the genres: Just create a list so the items are pasted
# into it. I think a structure similar to this would be helpful in putting the
# genres into the dataframe.

for(n in 1:nrow(uk2000_tracks)){
  SongID <- uk2000_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2000_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2001_tracks)){
  SongID <- uk2001_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2001_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2002_tracks)){
  SongID <- uk2002_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2002_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2003_tracks)){
  SongID <- uk2003_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2003_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2004_tracks)){
  SongID <- uk2004_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2004_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2005_tracks)){
  SongID <- uk2005_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2005_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2006_tracks)){
  SongID <- uk2006_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2006_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2007_tracks)){
  SongID <- uk2007_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2007_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2008_tracks)){
  SongID <- uk2008_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2008_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2009_tracks)){
  SongID <- uk2009_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2009_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}

for(n in 1:nrow(uk2010_tracks)){
  SongID <- uk2010_tracks$track.artist[[n]][[2]]
  SongGenre <- get_artist(SongID[1])
  uk2010_tracks$genre[n] <- paste(unlist(SongGenre[["genres"]]),
                                  sep="", collapse=",")
}
# Sample plot graph for genres

ggplot(same_tracks_2020, aes(year)) +
  geom_bar() +
  geom_bar(data = same_tracks_2019) +
  geom_bar(data = same_tracks_2018) +
  geom_bar(data = same_tracks_2017) +
  theme_classic() +
  labs(title = "Number of Top Songs in Both Germany and UK",
       subtitle = "By Spotify daily stream",
       x = "Year",
       y = "Number of Songs")
```

# Data Gathered Thus Far
As you can see above, the data I have only consists of the top 100 music hits in the UK from the year 2000. Why has such little data been gathered? I wanted to show what the rest of the code would look like once I gather all the data from 2000-2010 from the UK and Germany. Although it doesn't look like much code, this will probably be over a thousand lines long by the end of the week. 

# How did you get this fine piece of data?
Thank you for asking stranger. I got this data by scraping the list from this website: http://www.uk-charts.top-source.info/index.shtml. I will continue to get data from this website from 2000-2010 for the UK, then I will use https://www.offiziellecharts.de to get the data for Germany. 

# Why did you stop after 1 year?
This was mostly me just testing the waters of what I can do with the data I gathered. Obviously this isn't the final project, it's not even %5 of the final project. I still have to scrape 1,900 more songs, and probably bind all of the data into two big chunks of 10 years of observations for Germany and UK. However, I will have to figure out how to get Spotify to analyze the data in the "titles" section of the UK data (it currently returns a lot of NULL observations, so I will have to read more of the sportifyr documentation). I should have all the data I want by tomorrow, and I will have to figure out how to get spotify to read that data over the weekend so I can start making some nice looking graphs. Overall, I think I am pretty happy where I am with this project.

# Are you going to keep updating this repo?

Of course! Everything pushed after today is just me gathering data from the UK and Germany charts. Hopefully by Sunday I will have created two massive chunks of data, but that is if I can get the spotify function to work. It is crucial for me to do this because most of the spotify commands involving track analysis can only take 100 observations at once.

Here is the repo for your convenience:
https://github.com/NinthHeaven/milestone4
